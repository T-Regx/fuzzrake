{% extends '_base.html.twig' %}

{% block javascripts %}
    {{ parent() }}

    {{ encore_entry_script_tags('main') }}

    <script>
        {% include 'main/parts/data.js.twig' %}
    </script>
{% endblock %}

{% block stylesheets %}
    {{ parent() }}

    {{ encore_entry_link_tags('main') }}
{% endblock %}

{% block body %}
    {% include 'main/modals/filters.html.twig' %}

    {% include 'main/modals/legend.html.twig' %}

    <div class="modal fade" id="artisanUpdatesModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content" id="artisanUpdatesModalContent"></div>
        </div>
    </div>

    <div class="modal fade" id="artisanDetailsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content artisan-data" id="artisanDetailsModalContent"></div>
        </div>
    </div>

    {% include 'main/parts/intro.html.twig' %}

    {% include 'main/parts/checklist.html.twig' %}

    <div id="data-loading-message" class="alert alert-primary" role="alert">
        The data is being processed. This may take several seconds. If it's stuck for
        <strong>more than half a minute</strong>, you may want to try:

        <ul>
            <li>refreshing the page / clearing the cache</li>
            <li>using the "incognito mode"</li>
            <li>using other browser or device</li>
        </ul>
    </div>

    <div id="data-table-content-container" style="display: none;">
        <div id="maker-mode-warning" class="card border-danger mb-3">
            <div class="card-header">
                Filters disabled
            </div>
            <div class="card-body">
                <p class="card-text">All filtering has been temporarily disabled to ease searching the whole database. Use the below button to restore them.</p>
                <a href="{{ path('main') }}" id="btn-reenable-filters" class="btn btn-light btn-outline-danger">Re-enable filters</a>
            </div>
        </div>

        <div id="data-table-container" style="display: none;">
            <div class="btn-group mb-2" role="group" aria-label="Menus and legend">
                <div id="columnsControlPanel" class="btn-group" role="group">
                    <button type="button" class="btn btn-dark dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                        Columns
                    </button>
                    <ul class="dropdown-menu">
                        <li data-col-name="makerId"><a class="dropdown-item" href="#">Maker ID</a></li>
                        <li data-col-name="state"><a class="dropdown-item" href="#">State</a></li>
                        <li data-col-name="languages"><a class="dropdown-item" href="#">Languages</a></li>
                        <li data-col-name="productionModels"><a class="dropdown-item" href="#">Production models</a></li>
                        <li data-col-name="styles"><a class="dropdown-item" href="#">Styles</a></li>
                        <li data-col-name="types"><a class="dropdown-item" href="#">Types</a></li>
                        <li data-col-name="features"><a class="dropdown-item" href="#">Features</a></li>
                        <li data-col-name="species"><a class="dropdown-item" href="#">Species</a></li>
                        <li data-col-name="commissions"><a class="dropdown-item" href="#">Commissions</a></li>
                        <li data-col-name="links"><a class="dropdown-item" href="#">Links</a></li>
                    </ul>
                </div>

                <button id="filtersButton" type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#filtersModal">
                    {# Caption is dynamic #}
                </button>
                <button type="button" class="btn btn-info" data-bs-toggle="modal" data-bs-target="#legendModal">
                    Legend
                </button>

                {# TODO: Text-based search, see CSS.searchable #}
            </div>

            <table id="artisans" class="table table-striped table-sm table-hover">
                <thead class="table-dark">
                    <tr>
                        <th class="name             text-start">Fursuit maker /&nbsp;studio name</th>
                        <th class="makerId          text-center">Maker ID</th>
                        <th class="state            text-center">State</th>
                        <th class="languages        text-center">Languages</th>
                        <th class="productionModels text-center">Production models</th>
                        <th class="styles           text-center">Styles</th>
                        <th class="types            text-center">Types</th>
                        <th class="features         text-center">Features</th>
                        <th class="species          text-center">Species</th>
                        <th class="commissions      text-center">Commissions</th>
                        <th class="links            text-end">Links</th>
                        <th class="hidden           searchable">Data for searching</th>
                    </tr>
                </thead>

                <tbody>
                </tbody>
            </table>
        </div>
    </div>

    <div class="container text-center">
        <img src="{{ asset('images/website-banner-bottom.webp') }}" class="img-fluid" alt="">
    </div>
{% endblock %}
